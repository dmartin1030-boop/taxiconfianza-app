<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Publicar oferta | TaxiConfianza</title>

  <!-- MISMO THEME que conductor-ofertas.html -->
  <link rel="stylesheet" href="css/dashboard-theme.css" />

  <style>
    /* Estilos SOLO de formulario + tabla + modal (mantienen el mismo tema) */
    .table{width:100%; border-collapse:collapse; min-width:900px;}
    .table th,.table td{padding:12px; border-bottom:1px solid var(--border); text-align:left; font-size:13px; vertical-align:top}
    .table th{color:var(--muted); font-weight:700}
    .right{text-align:right}

    .filters{display:grid; grid-template-columns:1fr; gap:10px}
    .field label{display:block; font-size:12px; color:var(--muted); margin:0 0 6px}
    .input, select, textarea{
      width:100%;
      background: rgba(0,0,0,.18);
      border:1px solid var(--border);
      border-radius: 12px;
      padding:10px 12px;
      color: var(--text);
      outline:none;
      font-size:13px;
      box-sizing:border-box;
    }
    textarea{min-height:92px; resize:vertical}

    .actions-row{display:flex; gap:10px; justify-content:flex-end; flex-wrap:wrap}
    .kpi{display:flex; gap:10px; flex-wrap:wrap}
    .kpi .pill{background: rgba(255,255,255,.03)}

    .two{display:grid; grid-template-columns: 1fr; gap:12px}
    @media(min-width: 980px){ .two{grid-template-columns: 1.1fr .9fr} }

    dialog{
      border:1px solid var(--border);
      border-radius: var(--radius);
      background: rgba(15,23,42,.98);
      color: var(--text);
      max-width: 820px;
      width: min(92vw, 820px);
      box-shadow: var(--shadow);
    }
    dialog::backdrop{background: rgba(0,0,0,.60)}
    .dlg-head{display:flex; align-items:flex-start; justify-content:space-between; gap:12px; margin-bottom:10px}
    .dlg-title{margin:0; font-size:16px}
    .hr{height:1px; background: var(--border); margin: 12px 0}
    .small{font-size:12px; color:var(--muted)}
    .disabled{opacity:.55; pointer-events:none}
    .danger{background: rgba(239,68,68,.12); border-color: rgba(239,68,68,.25)}
  </style>
</head>

<body>
  <div class="wrap">
    <!-- SIDEBAR -->
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <div class="logo">TC</div>
        <div>
          <h1>TaxiConfianza</h1>
          <p>Panel Propietario</p>
        </div>
      </div>

      <nav class="nav" aria-label="Navegación del propietario">
        <a href="dashboard-propietario.html">
          <svg class="ico" viewBox="0 0 24 24" fill="none">
            <path d="M4 10.5L12 4l8 6.5V20a1.5 1.5 0 0 1-1.5 1.5H5.5A1.5 1.5 0 0 1 4 20v-9.5Z"
              stroke="currentColor" stroke-width="1.6"/>
          </svg>
          Dashboard
        </a>

        <a class="active" href="publicar-oferta.html" aria-current="page">
          <svg class="ico" viewBox="0 0 24 24" fill="none">
            <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          </svg>
          Publicar oferta
        </a>

        <a href="mis-ofertas.html" class="disabled" title="Si quieres, lo conectamos después">
          <svg class="ico" viewBox="0 0 24 24" fill="none">
            <path d="M4 7h16M4 12h16M4 17h10" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          </svg>
          Mis ofertas
        </a>

        <a href="postulaciones-propietario.html" class="disabled" title="Si quieres, lo conectamos después">
          <svg class="ico" viewBox="0 0 24 24" fill="none">
            <path d="M7 8h10M7 12h6M7 16h10" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M5 4h14a2 2 0 0 1 2 2v14l-4-2H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2Z"
              stroke="currentColor" stroke-width="1.6"/>
          </svg>
          Postulaciones
        </a>

        <a href="trabajo-actual.html" class="disabled" title="Si quieres, lo conectamos después">
          <svg class="ico" viewBox="0 0 24 24" fill="none">
            <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M21 12a9 9 0 1 1-9-9 9 9 0 0 1 9 9Z" stroke="currentColor" stroke-width="1.6"/>
          </svg>
          Trabajo actual
        </a>

        <a href="historial-trabajos.html" class="disabled" title="Si quieres, lo conectamos después">
          <svg class="ico" viewBox="0 0 24 24" fill="none">
            <path d="M7 4h10v4H7V4Z" stroke="currentColor" stroke-width="1.6"/>
            <path d="M6 8h12v12H6V8Z" stroke="currentColor" stroke-width="1.6"/>
          </svg>
          Historial de trabajos
        </a>
      </nav>

      <div class="sep"></div>

      <div class="mini">
        <div class="row">
          <div>
            <small>Sesión</small>
            <div class="pill"><span class="dot"></span><span id="user-pill">—</span></div>
          </div>
        </div>
      </div>

      <div class="sep"></div>

      <button class="btn danger" id="btnLogout" style="width:100%; justify-content:center">Salir</button>
    </aside>

    <div class="overlay" id="overlay"></div>

    <!-- MAIN -->
    <main class="main">
      <header class="topbar">
        <div class="left">
          <h2 class="title">Publicar oferta</h2>
          <p class="subtitle">Crea ofertas en <code>ofertas_trabajo</code> y adminístralas aquí mismo.</p>
        </div>

        <div class="top-actions">
          <button class="btn mobile-toggle" id="btnOpenMenu" type="button" aria-label="Abrir menú">☰ Menú</button>

          <div class="search" role="search" aria-label="Buscar mis ofertas">
            <svg class="ico" viewBox="0 0 24 24" fill="none">
              <path d="M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="currentColor" stroke-width="1.6"/>
              <path d="M16.5 16.5 21 21" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            </svg>
            <input id="q" placeholder="Buscar por título, ciudad, requisitos…" />
          </div>

          <button class="btn primary" id="btnRefresh" type="button">Actualizar</button>
        </div>
      </header>

      <section class="grid">
        <!-- LISTA / MIS OFERTAS -->
        <article class="card">
          <div class="row" style="margin-bottom:10px;">
            <div class="kpi">
              <span class="pill">Mis ofertas: <strong id="count">0</strong></span>
              <span class="pill">Tu usuario: <strong id="who">—</strong></span>
            </div>
            <div class="muted" id="msg"></div>
          </div>

          <div style="overflow:auto; border-radius: 12px;">
            <table class="table">
              <thead>
                <tr>
                  <th>Oferta</th>
                  <th>Acuerdo</th>
                  <th>Vehículo</th>
                  <th>Ciudad / Turno</th>
                  <th>Estado</th>
                  <th class="right">Acciones</th>
                </tr>
              </thead>
              <tbody id="offersTable">
                <tr><td colspan="6" class="muted">Cargando…</td></tr>
              </tbody>
            </table>
          </div>
        </article>

        <!-- FORM / NUEVA OFERTA -->
        <article class="card">
          <h3>Nueva oferta</h3>
          <p class="muted">Campos reales de tu tabla <code>ofertas_trabajo</code>.</p>

          <div class="filters">
            <div class="field">
              <label>Vehículo</label>
              <select id="vehiculo_id">
                <option value="">Cargando vehículos…</option>
              </select>
              <div class="small">Se guarda como <b>vehiculo_id</b> y pertenece a tu perfil.</div>
            </div>

            <div class="field">
              <label>Título</label>
              <input class="input" id="titulo" placeholder="Ej: Taxi turno noche con pago diario" />
            </div>

            <div class="field">
              <label>Ciudad</label>
              <input class="input" id="ciudad" placeholder="Ej: Bogotá" />
            </div>

            <div class="two">
              <div class="field">
                <label>Turno</label>
                <select id="turno">
                  <option value="dia">Día</option>
                  <option value="noche">Noche</option>
                  <option value="mixto">Mixto</option>
                </select>
              </div>

              <div class="field">
                <label>Estado</label>
                <select id="estado">
                  <option value="activa" selected>Activa</option>
                  <option value="pausada">Pausada</option>
                  <option value="cerrada">Cerrada</option>
                </select>
              </div>
            </div>

            <div class="field">
              <label>Descripción</label>
              <textarea id="descripcion" placeholder="Describe condiciones, horarios, zonas, etc."></textarea>
            </div>

            <div class="two">
              <div class="field">
                <label>Cuota diaria ($)</label>
                <input class="input" id="cuota_diaria" type="number" min="0" placeholder="Ej: 70000" />
              </div>
              <div class="field">
                <label>% Propietario</label>
                <input class="input" id="porcentaje_propietario" type="number" step="0.01" min="0" placeholder="Ej: 30.00" />
              </div>
            </div>

            <div class="small">
              Debes llenar <b>cuota_diaria</b> o <b>porcentaje_propietario</b> (al menos uno).
            </div>

            <div class="field">
              <label>Requisitos</label>
              <textarea id="requisitos" placeholder="Ej: licencia vigente, sin comparendos, experiencia 1 año…"></textarea>
            </div>

            <div class="actions-row">
              <button class="btn" type="button" id="btnClear">Limpiar</button>
              <button class="btn primary" type="button" id="btnCreate">Publicar</button>
            </div>

            <p class="small">
              Tip: si una oferta está <b>bloqueada</b>, el sistema no permitirá cambiar su estado.
            </p>
          </div>
        </article>
      </section>
    </main>
  </div>

  <!-- MODAL: Ver/Editar rápido (solo estado + ver detalle) -->
  <dialog id="offerDialog">
    <form method="dialog" id="offerForm">
      <div class="dlg-head">
        <div>
          <h3 class="dlg-title" id="dlgTitle">Oferta</h3>
          <div class="small" id="dlgMeta"></div>
        </div>
        <button class="btn" value="cancel" type="submit">✕</button>
      </div>

      <div class="two">
        <div>
          <div class="muted" style="margin-bottom:6px;">Descripción</div>
          <div id="dlgDesc" class="small"></div>

          <div class="hr"></div>

          <div class="muted" style="margin-bottom:6px;">Requisitos</div>
          <div id="dlgReq" class="small"></div>
        </div>

        <div>
          <div class="muted" style="margin-bottom:6px;">Acciones</div>

          <div class="field">
            <label>Estado</label>
            <select id="dlgEstado">
              <option value="activa">activa</option>
              <option value="pausada">pausada</option>
              <option value="cerrada">cerrada</option>
            </select>
            <div class="small" id="dlgLockMsg"></div>
          </div>

          <div class="actions-row" style="margin-top:10px;">
            <button class="btn" value="cancel" type="submit">Cancelar</button>
            <button class="btn primary" id="btnSaveEstado" type="button">Guardar</button>
            <button class="btn danger" id="btnDeleteOffer" type="button">Eliminar</button>
          </div>

          <div class="muted" id="dlgStatus" style="margin-top:10px;"></div>
        </div>
      </div>
    </form>
  </dialog>

  <!-- mismos JS base que tu plantilla -->
  <script src="js/tc-session.js"></script>
  <script src="js/tc-api.js"></script>

  <!-- crea este archivo (te lo hago en el siguiente paso si quieres) -->
  <script src="js/tc-propietario-publicar-oferta.js"></script>
</body>
</html>

